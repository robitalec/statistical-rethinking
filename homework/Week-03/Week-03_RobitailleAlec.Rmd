---
title: "Week 3"
author: "Alec L. Robitaille"
date: "2021-08-25 [updated: `r Sys.Date()`]"
output: github_document
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rethinking)
```

# Overview

All three problems below are based on the same data. The data in `data(foxes)`
are 116 foxes from 30 different urban groups in England. These foxes are like
street gangs. Group size varies from 2 to 8 individuals. Each group maintains
its own (almost exclusive) urban territory. Some territories are larger than
others. The area variable encodes this information. Some territories also have
more avgfood than others. We want to model the weight of each fox. For the
problems below, assume this DAG


## Question 1
Setup DAG

```{r dag}
library(ggdag)
library(dagitty)
library(data.table)
library(ggplot2)

dag_plot <- function(dag) {
	stat <- node_status(dag, FALSE)
	stat$data$status[is.na(stat$data$status)] <- 'intermediate'
	ggplot(stat, aes(x = x, y = y, xend = xend, yend = yend)) +
	  geom_dag_point(aes(color = status), alpha = 0.5, size = 15) +
	  geom_dag_edges() +
		labs(color = '') + 
	  geom_dag_text(color = 'black') +
		scale_color_manual(values = list('exposure' = '#35608DFF',
																		 'outcome' = '#22A884FF',
																		 'intermediate' = 'grey50')) + 
	  theme_void()
}

dag <- dagify(
	weight ~ groupsize + avgfood,
	groupsize ~ avgfood,
	avgfood ~ area,
	exposure = 'area',
	outcome = 'weight'
)

dag_plot(dag)

dag_paths(dag)  
```
