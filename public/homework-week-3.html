<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Homework: Week 3 | Learning bayesian data analysis with Statistical Rethinking</title>
  <meta name="description" content="4 Homework: Week 3 | Learning bayesian data analysis with Statistical Rethinking" />
  <meta name="generator" content="bookdown 0.22.15 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Homework: Week 3 | Learning bayesian data analysis with Statistical Rethinking" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Homework: Week 3 | Learning bayesian data analysis with Statistical Rethinking" />
  
  
  

<meta name="author" content="Alec L. Robitaille" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="homework-week-2.html"/>
<link rel="next" href="homework-week-4.html"/>
<script src="libs/header-attrs-2.9.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#links"><i class="fa fa-check"></i><b>1.1</b> Links</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#adaptations"><i class="fa fa-check"></i><b>1.1.1</b> Adaptations</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#etc"><i class="fa fa-check"></i><b>1.1.2</b> Etc</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#seed"><i class="fa fa-check"></i><b>1.2</b> Seed</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="homework-week-1.html"><a href="homework-week-1.html"><i class="fa fa-check"></i><b>2</b> Homework: Week 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="homework-week-1.html"><a href="homework-week-1.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="homework-week-1.html"><a href="homework-week-1.html#joint-model"><i class="fa fa-check"></i><b>2.2</b> Joint model</a></li>
<li class="chapter" data-level="2.3" data-path="homework-week-1.html"><a href="homework-week-1.html#question-1"><i class="fa fa-check"></i><b>2.3</b> Question 1</a></li>
<li class="chapter" data-level="2.4" data-path="homework-week-1.html"><a href="homework-week-1.html#question-2"><i class="fa fa-check"></i><b>2.4</b> Question 2</a></li>
<li class="chapter" data-level="2.5" data-path="homework-week-1.html"><a href="homework-week-1.html#question-3"><i class="fa fa-check"></i><b>2.5</b> Question 3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="homework-week-2.html"><a href="homework-week-2.html"><i class="fa fa-check"></i><b>3</b> Homework: Week 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="homework-week-2.html"><a href="homework-week-2.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1</a></li>
<li class="chapter" data-level="3.2" data-path="homework-week-2.html"><a href="homework-week-2.html#question-2-1"><i class="fa fa-check"></i><b>3.2</b> Question 2</a></li>
<li class="chapter" data-level="3.3" data-path="homework-week-2.html"><a href="homework-week-2.html#homework-question-3"><i class="fa fa-check"></i><b>3.3</b> Homework: Question 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="homework-week-3.html"><a href="homework-week-3.html"><i class="fa fa-check"></i><b>4</b> Homework: Week 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="homework-week-3.html"><a href="homework-week-3.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="homework-week-3.html"><a href="homework-week-3.html#setup"><i class="fa fa-check"></i><b>4.1.1</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="homework-week-3.html"><a href="homework-week-3.html#question-1-2"><i class="fa fa-check"></i><b>4.2</b> Question 1</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="homework-week-3.html"><a href="homework-week-3.html#workings"><i class="fa fa-check"></i><b>4.2.1</b> Workings</a></li>
<li class="chapter" data-level="4.2.2" data-path="homework-week-3.html"><a href="homework-week-3.html#model"><i class="fa fa-check"></i><b>4.2.2</b> Model</a></li>
<li class="chapter" data-level="4.2.3" data-path="homework-week-3.html"><a href="homework-week-3.html#prior-predictive-simulation"><i class="fa fa-check"></i><b>4.2.3</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="4.2.4" data-path="homework-week-3.html"><a href="homework-week-3.html#paths"><i class="fa fa-check"></i><b>4.2.4</b> Paths</a></li>
<li class="chapter" data-level="4.2.5" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation"><i class="fa fa-check"></i><b>4.2.5</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="homework-week-3.html"><a href="homework-week-3.html#question-2-2"><i class="fa fa-check"></i><b>4.3</b> Question 2</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="homework-week-3.html"><a href="homework-week-3.html#paths-1"><i class="fa fa-check"></i><b>4.3.1</b> Paths</a></li>
<li class="chapter" data-level="4.3.2" data-path="homework-week-3.html"><a href="homework-week-3.html#model-1"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation-1"><i class="fa fa-check"></i><b>4.3.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="homework-week-3.html"><a href="homework-week-3.html#question-3-1"><i class="fa fa-check"></i><b>4.4</b> Question 3</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="homework-week-3.html"><a href="homework-week-3.html#paths-2"><i class="fa fa-check"></i><b>4.4.1</b> Paths</a></li>
<li class="chapter" data-level="4.4.2" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation-2"><i class="fa fa-check"></i><b>4.4.2</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="homework-week-4.html"><a href="homework-week-4.html"><i class="fa fa-check"></i><b>5</b> Homework: Week 4</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="homework-week-4.html"><a href="homework-week-4.html#setup-1"><i class="fa fa-check"></i><b>5.0.1</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lecture-01.html"><a href="lecture-01.html"><i class="fa fa-check"></i><b>6</b> Lecture 01</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="lecture-01.html"><a href="lecture-01.html#popper"><i class="fa fa-check"></i><b>6.0.1</b> Popper</a></li>
<li class="chapter" data-level="6.0.2" data-path="lecture-01.html"><a href="lecture-01.html#approach"><i class="fa fa-check"></i><b>6.0.2</b> Approach</a></li>
<li class="chapter" data-level="6.1" data-path="lecture-01.html"><a href="lecture-01.html#hypotheses---process-models---statistical-models"><i class="fa fa-check"></i><b>6.1</b> Hypotheses - Process Models - Statistical Models</a></li>
<li class="chapter" data-level="6.2" data-path="lecture-01.html"><a href="lecture-01.html#small-world-large-world"><i class="fa fa-check"></i><b>6.2</b> Small world / large world</a></li>
<li class="chapter" data-level="6.3" data-path="lecture-01.html"><a href="lecture-01.html#example-four-marbles"><i class="fa fa-check"></i><b>6.3</b> Example: four marbles</a></li>
<li class="chapter" data-level="6.4" data-path="lecture-01.html"><a href="lecture-01.html#building-a-model"><i class="fa fa-check"></i><b>6.4</b> Building a model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lecture-02.html"><a href="lecture-02.html"><i class="fa fa-check"></i><b>7</b> Lecture 02</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lecture-02.html"><a href="lecture-02.html#joint-prior-distribution"><i class="fa fa-check"></i><b>7.1</b> Joint prior distribution</a></li>
<li class="chapter" data-level="7.2" data-path="lecture-02.html"><a href="lecture-02.html#example-inflatable-world"><i class="fa fa-check"></i><b>7.2</b> Example: inflatable world</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="lecture-02.html"><a href="lecture-02.html#design-the-model"><i class="fa fa-check"></i><b>7.2.1</b> <strong>Design the model</strong></a></li>
<li class="chapter" data-level="7.2.2" data-path="lecture-02.html"><a href="lecture-02.html#condition"><i class="fa fa-check"></i><b>7.2.2</b> <strong>Condition</strong></a></li>
<li class="chapter" data-level="7.2.3" data-path="lecture-02.html"><a href="lecture-02.html#evaluate"><i class="fa fa-check"></i><b>7.2.3</b> <strong>Evaluate</strong></a></li>
<li class="chapter" data-level="7.2.4" data-path="lecture-02.html"><a href="lecture-02.html#define-parameters"><i class="fa fa-check"></i><b>7.2.4</b> Define parameters</a></li>
<li class="chapter" data-level="7.2.5" data-path="lecture-02.html"><a href="lecture-02.html#joint-model-1"><i class="fa fa-check"></i><b>7.2.5</b> Joint model</a></li>
<li class="chapter" data-level="7.2.6" data-path="lecture-02.html"><a href="lecture-02.html#posterior"><i class="fa fa-check"></i><b>7.2.6</b> Posterior</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="lecture-02.html"><a href="lecture-02.html#grid-approximation"><i class="fa fa-check"></i><b>7.3</b> Grid approximation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="lecture-02.html"><a href="lecture-02.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>7.3.1</b> Sampling from the posterior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lecture-03.html"><a href="lecture-03.html"><i class="fa fa-check"></i><b>8</b> Lecture 03</a>
<ul>
<li class="chapter" data-level="8.1" data-path="lecture-03.html"><a href="lecture-03.html#regressions"><i class="fa fa-check"></i><b>8.1</b> Regressions</a></li>
<li class="chapter" data-level="8.2" data-path="lecture-03.html"><a href="lecture-03.html#normal-distributions"><i class="fa fa-check"></i><b>8.2</b> Normal distributions</a></li>
<li class="chapter" data-level="8.3" data-path="lecture-03.html"><a href="lecture-03.html#prior-predictive-distributions"><i class="fa fa-check"></i><b>8.3</b> Prior predictive distributions</a></li>
<li class="chapter" data-level="8.4" data-path="lecture-03.html"><a href="lecture-03.html#quadratic-approximate"><i class="fa fa-check"></i><b>8.4</b> Quadratic approximate</a></li>
<li class="chapter" data-level="8.5" data-path="lecture-03.html"><a href="lecture-03.html#centering-variables"><i class="fa fa-check"></i><b>8.5</b> Centering variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lecture-04.html"><a href="lecture-04.html"><i class="fa fa-check"></i><b>9</b> Lecture 04</a>
<ul>
<li class="chapter" data-level="9.1" data-path="lecture-04.html"><a href="lecture-04.html#standardizing-variables"><i class="fa fa-check"></i><b>9.1</b> Standardizing variables</a></li>
<li class="chapter" data-level="9.2" data-path="lecture-04.html"><a href="lecture-04.html#plotting-uncertainty---sample-from-posterior"><i class="fa fa-check"></i><b>9.2</b> Plotting uncertainty - sample from posterior</a></li>
<li class="chapter" data-level="9.3" data-path="lecture-04.html"><a href="lecture-04.html#polynomials"><i class="fa fa-check"></i><b>9.3</b> Polynomials</a></li>
<li class="chapter" data-level="9.4" data-path="lecture-04.html"><a href="lecture-04.html#splines"><i class="fa fa-check"></i><b>9.4</b> Splines</a></li>
<li class="chapter" data-level="9.5" data-path="lecture-04.html"><a href="lecture-04.html#basis-splines"><i class="fa fa-check"></i><b>9.5</b> Basis splines</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="lecture-04.html"><a href="lecture-04.html#recipe"><i class="fa fa-check"></i><b>9.5.1</b> Recipe</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lecture-05.html"><a href="lecture-05.html"><i class="fa fa-check"></i><b>10</b> Lecture 05</a>
<ul>
<li class="chapter" data-level="10.1" data-path="lecture-05.html"><a href="lecture-05.html#multiple-regression-models"><i class="fa fa-check"></i><b>10.1</b> Multiple regression models</a></li>
<li class="chapter" data-level="10.2" data-path="lecture-05.html"><a href="lecture-05.html#directed-acyclic-graphs-dag"><i class="fa fa-check"></i><b>10.2</b> Directed acyclic graphs (DAG)</a></li>
<li class="chapter" data-level="10.3" data-path="lecture-05.html"><a href="lecture-05.html#example-age-marriage-divorce"><i class="fa fa-check"></i><b>10.3</b> Example: Age, marriage, divorce</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="lecture-05.html"><a href="lecture-05.html#priors"><i class="fa fa-check"></i><b>10.3.1</b> Priors</a></li>
<li class="chapter" data-level="10.3.2" data-path="lecture-05.html"><a href="lecture-05.html#prior-predictive-simulation-1"><i class="fa fa-check"></i><b>10.3.2</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="10.3.3" data-path="lecture-05.html"><a href="lecture-05.html#interpretation-3"><i class="fa fa-check"></i><b>10.3.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="lecture-05.html"><a href="lecture-05.html#plotting-multivariate-posteriors"><i class="fa fa-check"></i><b>10.4</b> Plotting multivariate posteriors</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="lecture-05.html"><a href="lecture-05.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>10.4.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="lecture-05.html"><a href="lecture-05.html#reveal-masked-associations"><i class="fa fa-check"></i><b>10.5</b> Reveal masked associations</a></li>
<li class="chapter" data-level="10.6" data-path="lecture-05.html"><a href="lecture-05.html#categorical-variables"><i class="fa fa-check"></i><b>10.6</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="lecture-05.html"><a href="lecture-05.html#dummy-variable"><i class="fa fa-check"></i><b>10.6.1</b> Dummy variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lecture-06.html"><a href="lecture-06.html"><i class="fa fa-check"></i><b>11</b> Lecture 06</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lecture-06.html"><a href="lecture-06.html#index-variable"><i class="fa fa-check"></i><b>11.1</b> Index variable</a></li>
<li class="chapter" data-level="11.2" data-path="lecture-06.html"><a href="lecture-06.html#four-elemental-confounds"><i class="fa fa-check"></i><b>11.2</b> Four elemental confounds</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="lecture-06.html"><a href="lecture-06.html#notes"><i class="fa fa-check"></i><b>11.2.1</b> Notes</a></li>
<li class="chapter" data-level="11.2.2" data-path="lecture-06.html"><a href="lecture-06.html#the-fork"><i class="fa fa-check"></i><b>11.2.2</b> The fork</a></li>
<li class="chapter" data-level="11.2.3" data-path="lecture-06.html"><a href="lecture-06.html#the-path"><i class="fa fa-check"></i><b>11.2.3</b> The path</a></li>
<li class="chapter" data-level="11.2.4" data-path="lecture-06.html"><a href="lecture-06.html#the-collider"><i class="fa fa-check"></i><b>11.2.4</b> The collider</a></li>
<li class="chapter" data-level="11.2.5" data-path="lecture-06.html"><a href="lecture-06.html#steps"><i class="fa fa-check"></i><b>11.2.5</b> Steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lecture-07.html"><a href="lecture-07.html"><i class="fa fa-check"></i><b>12</b> Lecture 07</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lecture-07.html"><a href="lecture-07.html#four-elemental-confounds-continued"><i class="fa fa-check"></i><b>12.1</b> Four elemental confounds (continued)</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="lecture-07.html"><a href="lecture-07.html#unobserved-variables"><i class="fa fa-check"></i><b>12.1.1</b> Unobserved variables</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="lecture-07.html"><a href="lecture-07.html#over-fitting"><i class="fa fa-check"></i><b>12.2</b> Over fitting</a></li>
<li class="chapter" data-level="12.3" data-path="lecture-07.html"><a href="lecture-07.html#measuring-model-fit"><i class="fa fa-check"></i><b>12.3</b> Measuring model fit</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="lecture-07.html"><a href="lecture-07.html#r-squared"><i class="fa fa-check"></i><b>12.3.1</b> R squared</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="lecture-07.html"><a href="lecture-07.html#obtaining-the-regular-features"><i class="fa fa-check"></i><b>12.4</b> Obtaining the regular features</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lecture-08.html"><a href="lecture-08.html"><i class="fa fa-check"></i><b>13</b> Lecture 08</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning bayesian data analysis with Statistical Rethinking</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="homework-week-3" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Homework: Week 3</h1>
<p>2021-08-25 [updated: 2021-08-30]</p>
<div id="overview-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Overview</h2>
<p>All three problems below are based on the same data. The data in <code>data(foxes)</code>
are 116 foxes from 30 different urban groups in England. These foxes are like
street gangs. Group size varies from 2 to 8 individuals. Each group maintains
its own (almost exclusive) urban territory. Some territories are larger than
others. The area variable encodes this information. Some territories also have
more avgfood than others. We want to model the weight of each fox. For the
problems below, assume this DAG</p>
<div id="setup" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Setup</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="homework-week-3.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb30-2"><a href="homework-week-3.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb30-3"><a href="homework-week-3.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb30-4"><a href="homework-week-3.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb30-5"><a href="homework-week-3.html#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-6"><a href="homework-week-3.html#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb30-7"><a href="homework-week-3.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="homework-week-3.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># DAG</span></span>
<span id="cb30-9"><a href="homework-week-3.html#cb30-9" aria-hidden="true" tabindex="-1"></a>dag_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dag) {</span>
<span id="cb30-10"><a href="homework-week-3.html#cb30-10" aria-hidden="true" tabindex="-1"></a>    stat <span class="ot">&lt;-</span> <span class="fu">node_status</span>(dag, <span class="cn">FALSE</span>)</span>
<span id="cb30-11"><a href="homework-week-3.html#cb30-11" aria-hidden="true" tabindex="-1"></a>    stat<span class="sc">$</span>data<span class="sc">$</span>status[<span class="fu">is.na</span>(stat<span class="sc">$</span>data<span class="sc">$</span>status)] <span class="ot">&lt;-</span> <span class="st">&#39;intermediate&#39;</span></span>
<span id="cb30-12"><a href="homework-week-3.html#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(stat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb30-13"><a href="homework-week-3.html#cb30-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="homework-week-3.html#cb30-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb30-15"><a href="homework-week-3.html#cb30-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&#39;&#39;</span>) <span class="sc">+</span> </span>
<span id="cb30-16"><a href="homework-week-3.html#cb30-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="homework-week-3.html#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">list</span>(<span class="st">&#39;exposure&#39;</span> <span class="ot">=</span> <span class="st">&#39;#35608DFF&#39;</span>,</span>
<span id="cb30-18"><a href="homework-week-3.html#cb30-18" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="st">&#39;outcome&#39;</span> <span class="ot">=</span> <span class="st">&#39;#22A884FF&#39;</span>,</span>
<span id="cb30-19"><a href="homework-week-3.html#cb30-19" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="st">&#39;intermediate&#39;</span> <span class="ot">=</span> <span class="st">&#39;grey50&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb30-20"><a href="homework-week-3.html#cb30-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb30-21"><a href="homework-week-3.html#cb30-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-22"><a href="homework-week-3.html#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="homework-week-3.html#cb30-23" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb30-24"><a href="homework-week-3.html#cb30-24" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> groupsize <span class="sc">+</span> avgfood,</span>
<span id="cb30-25"><a href="homework-week-3.html#cb30-25" aria-hidden="true" tabindex="-1"></a>    groupsize <span class="sc">~</span> avgfood,</span>
<span id="cb30-26"><a href="homework-week-3.html#cb30-26" aria-hidden="true" tabindex="-1"></a>    avgfood <span class="sc">~</span> area,</span>
<span id="cb30-27"><a href="homework-week-3.html#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure =</span> <span class="st">&#39;area&#39;</span>,</span>
<span id="cb30-28"><a href="homework-week-3.html#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&#39;weight&#39;</span></span>
<span id="cb30-29"><a href="homework-week-3.html#cb30-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-30"><a href="homework-week-3.html#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="homework-week-3.html#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="fu">dag_plot</span>(dag)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="question-1-2" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Question 1</h2>
<blockquote>
<p>Use a model to infer the total causal influence of area on weight. Would
increasing the area available to each fox make it heavier (healthier)? You might
want to standardize the variables. Regardless, use prior predictive simulation
to show that your model’s prior predictions stay within the possible outcome
range.</p>
</blockquote>
<div id="workings" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Workings</h3>
<p>Area on weight</p>
<p>scale(weight) ~ dnorm(mu, sigma)<br />
mu &lt;- a + b * (scale(area))<br />
a: intercept<br />
when weight and area are scaled, the expected intercept is 0<br />
therefore<br />
a ~ dnorm(0, 0.5)</p>
<p>b: beta, rate of change given one unit of increase in area<br />
b ~ dnorm(0, 1)</p>
<p>sigma: standard deviation<br />
uniform prior<br />
sigma ~ dunif(0, 50)</p>
</div>
<div id="model" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Model</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="homework-week-3.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb31-2"><a href="homework-week-3.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="homework-week-3.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span>
<span id="cb31-4"><a href="homework-week-3.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="homework-week-3.html#cb31-5" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_area <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>area)</span>
<span id="cb31-6"><a href="homework-week-3.html#cb31-6" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_weight <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>weight)</span>
<span id="cb31-7"><a href="homework-week-3.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="homework-week-3.html#cb31-8" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb31-9"><a href="homework-week-3.html#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb31-10"><a href="homework-week-3.html#cb31-10" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb31-11"><a href="homework-week-3.html#cb31-11" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bArea <span class="sc">*</span> scale_area,</span>
<span id="cb31-12"><a href="homework-week-3.html#cb31-12" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.05</span>),</span>
<span id="cb31-13"><a href="homework-week-3.html#cb31-13" aria-hidden="true" tabindex="-1"></a>        bArea <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb31-14"><a href="homework-week-3.html#cb31-14" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb31-15"><a href="homework-week-3.html#cb31-15" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb31-16"><a href="homework-week-3.html#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb31-17"><a href="homework-week-3.html#cb31-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="prior-predictive-simulation" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Prior predictive simulation</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="homework-week-3.html#cb32-1" aria-hidden="true" tabindex="-1"></a>plot_link <span class="ot">&lt;-</span> <span class="cf">function</span>(DT, n) {</span>
<span id="cb32-2"><a href="homework-week-3.html#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.table</span>(DT)[<span class="fu">sample</span>(.N, n), </span>
<span id="cb32-3"><a href="homework-week-3.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">plot</span>(<span class="fu">data.table</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), .N), </span>
<span id="cb32-4"><a href="homework-week-3.html#cb32-4" aria-hidden="true" tabindex="-1"></a>                                                                 <span class="at">y =</span> <span class="fu">c</span>(V1, V2)),</span>
<span id="cb32-5"><a href="homework-week-3.html#cb32-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">type =</span> <span class="st">&#39;l&#39;</span>)]</span>
<span id="cb32-6"><a href="homework-week-3.html#cb32-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-7"><a href="homework-week-3.html#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="homework-week-3.html#cb32-8" aria-hidden="true" tabindex="-1"></a>prior <span class="ot">&lt;-</span> <span class="fu">extract.prior</span>(m1)</span>
<span id="cb32-9"><a href="homework-week-3.html#cb32-9" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">link</span>(m1, <span class="at">post =</span> prior, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">scale_area =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)))</span>
<span id="cb32-10"><a href="homework-week-3.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_link</span>(l, <span class="dv">20</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre><code>## NULL</code></pre>
</div>
<div id="paths" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Paths</h3>
<p>Interest: Area on Weight</p>
<p>Paths</p>
<ol style="list-style-type: decimal">
<li>Area -&gt; Avgfood -&gt; Weight</li>
<li>Area -&gt; Avgfood -&gt; Groupsize -&gt; Weight</li>
</ol>
<p>Avgfood and Groupsize are pipes between Area and Weight. There are
no backdoors or colliders.</p>
</div>
<div id="interpretation" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Interpretation</h3>
<blockquote>
<p>Would increasing the area available to each fox make it heavier (healthier)?</p>
</blockquote>
<p><code>bArea</code> has a mean of 0.02, with compatibility intervals around 0.
Therefore the model does not indicate a total causal influence of
area on the weight.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="homework-week-3.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m1)</span></code></pre></div>
<pre><code>##            mean    sd  5.5% 94.5%
## a     -0.000001 0.044 -0.07  0.07
## bArea  0.018844 0.091 -0.13  0.16
## sigma  0.995497 0.065  0.89  1.10</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="homework-week-3.html#cb36-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m1)</span>
<span id="cb36-2"><a href="homework-week-3.html#cb36-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sim</span>(m1, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">scale_area =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">post =</span> post)</span>
<span id="cb36-3"><a href="homework-week-3.html#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="homework-week-3.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.table</span>(s), <span class="fu">aes</span>(V1)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="homework-week-3.html#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">89</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
</div>
<div id="question-2-2" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Question 2</h2>
<blockquote>
<p>Now infer the causal impact of adding food to a territory. Would this make foxes
heavier? Which covariates do you need to adjust for to estimate the total causal
influence of food?</p>
</blockquote>
<div id="paths-1" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Paths</h3>
<p>Interest: Food on weight</p>
<p>Paths:</p>
<ol style="list-style-type: decimal">
<li>Food -&gt; Weight</li>
<li>Food -&gt; Groupsize -&gt; Weight</li>
</ol>
<p>Groupsize is a pipe between Area and Weight. There are no backdoors or colliders.</p>
</div>
<div id="model-1" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Model</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="homework-week-3.html#cb37-1" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_avgfood <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>avgfood)</span>
<span id="cb37-2"><a href="homework-week-3.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="homework-week-3.html#cb37-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb37-4"><a href="homework-week-3.html#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb37-5"><a href="homework-week-3.html#cb37-5" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb37-6"><a href="homework-week-3.html#cb37-6" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bFood <span class="sc">*</span> scale_avgfood,</span>
<span id="cb37-7"><a href="homework-week-3.html#cb37-7" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.05</span>),</span>
<span id="cb37-8"><a href="homework-week-3.html#cb37-8" aria-hidden="true" tabindex="-1"></a>        bFood <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb37-9"><a href="homework-week-3.html#cb37-9" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb37-10"><a href="homework-week-3.html#cb37-10" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb37-11"><a href="homework-week-3.html#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb37-12"><a href="homework-week-3.html#cb37-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-13"><a href="homework-week-3.html#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="homework-week-3.html#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m2)</span></code></pre></div>
<pre><code>##             mean    sd  5.5% 94.5%
## a      0.0000018 0.044 -0.07  0.07
## bFood -0.0241757 0.091 -0.17  0.12
## sigma  0.9953723 0.065  0.89  1.10</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="homework-week-3.html#cb39-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">extract.samples</span>(m2)</span>
<span id="cb39-2"><a href="homework-week-3.html#cb39-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sim</span>(m2, <span class="at">data =</span> <span class="fu">list</span>(<span class="at">scale_avgfood =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)), <span class="at">post =</span> post)</span>
<span id="cb39-3"><a href="homework-week-3.html#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="homework-week-3.html#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.table</span>(s), <span class="fu">aes</span>(V1)) <span class="sc">+</span></span>
<span id="cb39-5"><a href="homework-week-3.html#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_halfeye</span>(<span class="at">.width =</span> .<span class="dv">89</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="interpretation-1" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Interpretation</h3>
<blockquote>
<p>Would this make foxes heavier? Which covariates do you need to adjust for to
estimate the total causal influence of food?</p>
</blockquote>
<p><code>bFood</code> has a mean of -0.02, with compatibility intervals around 0.
The model does not indicate a total causal influence of area on the weight.
No covariates are needed to estiamte the total causal influence of food
because there are no backdoors or colliders.</p>
</div>
</div>
<div id="question-3-1" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Question 3</h2>
<blockquote>
<p>Now infer the causal impact of group size. Which covariates do you need to
adjust for? Looking at the posterior distribution of the resulting model, what
do you think explains these data? That is, can you explain the estimates for all
three problems? How do they go together?</p>
</blockquote>
<div id="paths-2" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Paths</h3>
<p>Interest: Group size on weight</p>
<p>Paths:</p>
<ol style="list-style-type: decimal">
<li>Groupsize -&gt; Weight</li>
<li>Groupsize &lt;- Avgfood -&gt; Weight</li>
</ol>
<p>Avgfood is a collider between Groupsize and Weight. There is a backdoor
on Groupsize and the path is closed.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="homework-week-3.html#cb40-1" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_groupsize <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>groupsize)</span>
<span id="cb40-2"><a href="homework-week-3.html#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="homework-week-3.html#cb40-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb40-4"><a href="homework-week-3.html#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb40-5"><a href="homework-week-3.html#cb40-5" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb40-6"><a href="homework-week-3.html#cb40-6" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bGroupsize <span class="sc">*</span> scale_groupsize <span class="sc">+</span> bFood <span class="sc">*</span> scale_avgfood,</span>
<span id="cb40-7"><a href="homework-week-3.html#cb40-7" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.05</span>),</span>
<span id="cb40-8"><a href="homework-week-3.html#cb40-8" aria-hidden="true" tabindex="-1"></a>        bGroupsize <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb40-9"><a href="homework-week-3.html#cb40-9" aria-hidden="true" tabindex="-1"></a>        bFood <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb40-10"><a href="homework-week-3.html#cb40-10" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb40-11"><a href="homework-week-3.html#cb40-11" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb40-12"><a href="homework-week-3.html#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb40-13"><a href="homework-week-3.html#cb40-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-14"><a href="homework-week-3.html#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="homework-week-3.html#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m3)</span></code></pre></div>
<pre><code>##                   mean    sd   5.5%  94.5%
## a           0.00000062 0.043 -0.069  0.069
## bGroupsize -0.57250071 0.180 -0.860 -0.285
## bFood       0.47624205 0.180  0.189  0.763
## sigma       0.94590281 0.062  0.846  1.046</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="homework-week-3.html#cb42-1" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">data.table</span>(<span class="fu">extract.samples</span>(m3))[, .(bGroupsize, bFood)])</span></code></pre></div>
<pre><code>## Warning in melt.data.table(data.table(extract.samples(m3))[, .(bGroupsize, :
## id.vars and measure.vars are internally guessed when both are &#39;NULL&#39;. All
## non-numeric/integer/logical type columns are considered id.vars, which in this
## case are columns []. Consider providing at least one of &#39;id&#39; or &#39;measure&#39; vars
## in future.</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="homework-week-3.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(DT) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="homework-week-3.html#cb44-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="fu">aes</span>(value, <span class="at">fill =</span> variable), <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb44-3"><a href="homework-week-3.html#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="interpretation-2" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Interpretation</h3>
<blockquote>
<p>Which covariates do you need to adjust for? Looking at the posterior
distribution of the resulting model, what do you think explains these data? That
is, can you explain the estimates for all three problems? How do they go
together?</p>
</blockquote>
<p>The Avgfood covariate needs to be included since it is a collider between
Groupsize and Weight. The mean and compatibility intervals of bFood are positive,
while the mean and compatibility intervals of bGroupsize are negative. This
indicates food’s positive relationship with weight could be buffered or interacting
with the negative relationship of group size. Increased food leads to increased
body weight, but more food also results in larger groups, which decreases the
food availability.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="homework-week-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-week-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
