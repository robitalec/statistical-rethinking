<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Homework: Week 4 | Learning bayesian data analysis with Statistical Rethinking</title>
  <meta name="description" content="5 Homework: Week 4 | Learning bayesian data analysis with Statistical Rethinking" />
  <meta name="generator" content="bookdown 0.22.15 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Homework: Week 4 | Learning bayesian data analysis with Statistical Rethinking" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Homework: Week 4 | Learning bayesian data analysis with Statistical Rethinking" />
  
  
  

<meta name="author" content="Alec L. Robitaille" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="homework-week-3.html"/>
<link rel="next" href="homework-week-5.html"/>
<script src="libs/header-attrs-2.9.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#links"><i class="fa fa-check"></i><b>1.1</b> Links</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#adaptations"><i class="fa fa-check"></i><b>1.1.1</b> Adaptations</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#etc"><i class="fa fa-check"></i><b>1.1.2</b> Etc</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#seed"><i class="fa fa-check"></i><b>1.2</b> Seed</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="homework-week-1.html"><a href="homework-week-1.html"><i class="fa fa-check"></i><b>2</b> Homework: Week 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="homework-week-1.html"><a href="homework-week-1.html#variables"><i class="fa fa-check"></i><b>2.1</b> Variables</a></li>
<li class="chapter" data-level="2.2" data-path="homework-week-1.html"><a href="homework-week-1.html#joint-model"><i class="fa fa-check"></i><b>2.2</b> Joint model</a></li>
<li class="chapter" data-level="2.3" data-path="homework-week-1.html"><a href="homework-week-1.html#question-1"><i class="fa fa-check"></i><b>2.3</b> Question 1</a></li>
<li class="chapter" data-level="2.4" data-path="homework-week-1.html"><a href="homework-week-1.html#question-2"><i class="fa fa-check"></i><b>2.4</b> Question 2</a></li>
<li class="chapter" data-level="2.5" data-path="homework-week-1.html"><a href="homework-week-1.html#question-3"><i class="fa fa-check"></i><b>2.5</b> Question 3</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="homework-week-2.html"><a href="homework-week-2.html"><i class="fa fa-check"></i><b>3</b> Homework: Week 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="homework-week-2.html"><a href="homework-week-2.html#question-1-1"><i class="fa fa-check"></i><b>3.1</b> Question 1</a></li>
<li class="chapter" data-level="3.2" data-path="homework-week-2.html"><a href="homework-week-2.html#question-2-1"><i class="fa fa-check"></i><b>3.2</b> Question 2</a></li>
<li class="chapter" data-level="3.3" data-path="homework-week-2.html"><a href="homework-week-2.html#homework-question-3"><i class="fa fa-check"></i><b>3.3</b> Homework: Question 3</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="homework-week-3.html"><a href="homework-week-3.html"><i class="fa fa-check"></i><b>4</b> Homework: Week 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="homework-week-3.html"><a href="homework-week-3.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="homework-week-3.html"><a href="homework-week-3.html#setup"><i class="fa fa-check"></i><b>4.1.1</b> Setup</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="homework-week-3.html"><a href="homework-week-3.html#question-1-2"><i class="fa fa-check"></i><b>4.2</b> Question 1</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="homework-week-3.html"><a href="homework-week-3.html#workings"><i class="fa fa-check"></i><b>4.2.1</b> Workings</a></li>
<li class="chapter" data-level="4.2.2" data-path="homework-week-3.html"><a href="homework-week-3.html#model"><i class="fa fa-check"></i><b>4.2.2</b> Model</a></li>
<li class="chapter" data-level="4.2.3" data-path="homework-week-3.html"><a href="homework-week-3.html#prior-predictive-simulation"><i class="fa fa-check"></i><b>4.2.3</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="4.2.4" data-path="homework-week-3.html"><a href="homework-week-3.html#paths"><i class="fa fa-check"></i><b>4.2.4</b> Paths</a></li>
<li class="chapter" data-level="4.2.5" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation"><i class="fa fa-check"></i><b>4.2.5</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="homework-week-3.html"><a href="homework-week-3.html#question-2-2"><i class="fa fa-check"></i><b>4.3</b> Question 2</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="homework-week-3.html"><a href="homework-week-3.html#paths-1"><i class="fa fa-check"></i><b>4.3.1</b> Paths</a></li>
<li class="chapter" data-level="4.3.2" data-path="homework-week-3.html"><a href="homework-week-3.html#model-1"><i class="fa fa-check"></i><b>4.3.2</b> Model</a></li>
<li class="chapter" data-level="4.3.3" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation-1"><i class="fa fa-check"></i><b>4.3.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="homework-week-3.html"><a href="homework-week-3.html#question-3-1"><i class="fa fa-check"></i><b>4.4</b> Question 3</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="homework-week-3.html"><a href="homework-week-3.html#paths-2"><i class="fa fa-check"></i><b>4.4.1</b> Paths</a></li>
<li class="chapter" data-level="4.4.2" data-path="homework-week-3.html"><a href="homework-week-3.html#interpretation-2"><i class="fa fa-check"></i><b>4.4.2</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="homework-week-4.html"><a href="homework-week-4.html"><i class="fa fa-check"></i><b>5</b> Homework: Week 4</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="homework-week-4.html"><a href="homework-week-4.html#setup-1"><i class="fa fa-check"></i><b>5.0.1</b> Setup</a></li>
<li class="chapter" data-level="5.1" data-path="homework-week-4.html"><a href="homework-week-4.html#question-1-3"><i class="fa fa-check"></i><b>5.1</b> Question 1</a></li>
<li class="chapter" data-level="5.2" data-path="homework-week-4.html"><a href="homework-week-4.html#question-2-3"><i class="fa fa-check"></i><b>5.2</b> Question 2</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="homework-week-4.html"><a href="homework-week-4.html#dag"><i class="fa fa-check"></i><b>5.2.1</b> DAG</a></li>
<li class="chapter" data-level="5.2.2" data-path="homework-week-4.html"><a href="homework-week-4.html#data"><i class="fa fa-check"></i><b>5.2.2</b> Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="homework-week-4.html"><a href="homework-week-4.html#models"><i class="fa fa-check"></i><b>5.2.3</b> Models</a></li>
<li class="chapter" data-level="5.2.4" data-path="homework-week-4.html"><a href="homework-week-4.html#interpretation-3"><i class="fa fa-check"></i><b>5.2.4</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="homework-week-4.html"><a href="homework-week-4.html#question-3-2"><i class="fa fa-check"></i><b>5.3</b> Question 3</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="homework-week-4.html"><a href="homework-week-4.html#data-1"><i class="fa fa-check"></i><b>5.3.1</b> Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="homework-week-4.html"><a href="homework-week-4.html#models-1"><i class="fa fa-check"></i><b>5.3.2</b> Models</a></li>
<li class="chapter" data-level="5.3.3" data-path="homework-week-4.html"><a href="homework-week-4.html#dag-1"><i class="fa fa-check"></i><b>5.3.3</b> DAG</a></li>
<li class="chapter" data-level="5.3.4" data-path="homework-week-4.html"><a href="homework-week-4.html#interpretation-4"><i class="fa fa-check"></i><b>5.3.4</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="homework-week-5.html"><a href="homework-week-5.html"><i class="fa fa-check"></i><b>6</b> Homework: Week 5</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="homework-week-5.html"><a href="homework-week-5.html#setup-2"><i class="fa fa-check"></i><b>6.0.1</b> Setup</a></li>
<li class="chapter" data-level="6.1" data-path="homework-week-5.html"><a href="homework-week-5.html#question-1-4"><i class="fa fa-check"></i><b>6.1</b> Question 1</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="homework-week-5.html"><a href="homework-week-5.html#data-2"><i class="fa fa-check"></i><b>6.1.1</b> Data</a></li>
<li class="chapter" data-level="6.1.2" data-path="homework-week-5.html"><a href="homework-week-5.html#prior-predictive-simulation-1"><i class="fa fa-check"></i><b>6.1.2</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="6.1.3" data-path="homework-week-5.html"><a href="homework-week-5.html#model-2"><i class="fa fa-check"></i><b>6.1.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="homework-week-5.html"><a href="homework-week-5.html#question-2-4"><i class="fa fa-check"></i><b>6.2</b> Question 2</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="homework-week-5.html"><a href="homework-week-5.html#data-3"><i class="fa fa-check"></i><b>6.2.1</b> Data</a></li>
<li class="chapter" data-level="6.2.2" data-path="homework-week-5.html"><a href="homework-week-5.html#priors"><i class="fa fa-check"></i><b>6.2.2</b> Priors</a></li>
<li class="chapter" data-level="6.2.3" data-path="homework-week-5.html"><a href="homework-week-5.html#model-3"><i class="fa fa-check"></i><b>6.2.3</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="homework-week-5.html"><a href="homework-week-5.html#question-3-3"><i class="fa fa-check"></i><b>6.3</b> Question 3</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="homework-week-5.html"><a href="homework-week-5.html#data-4"><i class="fa fa-check"></i><b>6.3.1</b> Data</a></li>
<li class="chapter" data-level="6.3.2" data-path="homework-week-5.html"><a href="homework-week-5.html#model-4"><i class="fa fa-check"></i><b>6.3.2</b> Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="homework-week-6.html"><a href="homework-week-6.html"><i class="fa fa-check"></i><b>7</b> Homework: Week 6</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="homework-week-6.html"><a href="homework-week-6.html#setup-3"><i class="fa fa-check"></i><b>7.0.1</b> Setup</a></li>
<li class="chapter" data-level="7.1" data-path="homework-week-6.html"><a href="homework-week-6.html#question-1-5"><i class="fa fa-check"></i><b>7.1</b> Question 1</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="homework-week-6.html"><a href="homework-week-6.html#data-5"><i class="fa fa-check"></i><b>7.1.1</b> Data</a></li>
<li class="chapter" data-level="7.1.2" data-path="homework-week-6.html"><a href="homework-week-6.html#dag-2"><i class="fa fa-check"></i><b>7.1.2</b> DAG</a></li>
<li class="chapter" data-level="7.1.3" data-path="homework-week-6.html"><a href="homework-week-6.html#priors-1"><i class="fa fa-check"></i><b>7.1.3</b> Priors</a></li>
<li class="chapter" data-level="7.1.4" data-path="homework-week-6.html"><a href="homework-week-6.html#model-5"><i class="fa fa-check"></i><b>7.1.4</b> Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="homework-week-7.html"><a href="homework-week-7.html"><i class="fa fa-check"></i><b>8</b> Homework: Week 7</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="homework-week-7.html"><a href="homework-week-7.html#setup-4"><i class="fa fa-check"></i><b>8.0.1</b> Setup</a></li>
<li class="chapter" data-level="8.0.2" data-path="homework-week-7.html"><a href="homework-week-7.html#data-6"><i class="fa fa-check"></i><b>8.0.2</b> Data</a></li>
<li class="chapter" data-level="8.0.3" data-path="homework-week-7.html"><a href="homework-week-7.html#model-ordered-categorical-outcome"><i class="fa fa-check"></i><b>8.0.3</b> Model: ordered categorical outcome</a></li>
<li class="chapter" data-level="8.0.4" data-path="homework-week-7.html"><a href="homework-week-7.html#model-ordered-categorical-predictors"><i class="fa fa-check"></i><b>8.0.4</b> Model: ordered categorical predictors</a></li>
<li class="chapter" data-level="8.1" data-path="homework-week-7.html"><a href="homework-week-7.html#question-1-6"><i class="fa fa-check"></i><b>8.1</b> Question 1</a></li>
<li class="chapter" data-level="8.2" data-path="homework-week-7.html"><a href="homework-week-7.html#question-2-5"><i class="fa fa-check"></i><b>8.2</b> Question 2</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="homework-week-8.html"><a href="homework-week-8.html"><i class="fa fa-check"></i><b>9</b> Homework: Week 8</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="homework-week-8.html"><a href="homework-week-8.html#setup-5"><i class="fa fa-check"></i><b>9.0.1</b> Setup</a></li>
<li class="chapter" data-level="9.1" data-path="homework-week-8.html"><a href="homework-week-8.html#question-1-7"><i class="fa fa-check"></i><b>9.1</b> Question 1</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="homework-week-8.html"><a href="homework-week-8.html#data-7"><i class="fa fa-check"></i><b>9.1.1</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="homework-week-8.html"><a href="homework-week-8.html#question-2-6"><i class="fa fa-check"></i><b>9.2</b> Question 2</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="lecture-01.html"><a href="lecture-01.html"><i class="fa fa-check"></i><b>10</b> Lecture 01</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="lecture-01.html"><a href="lecture-01.html#popper"><i class="fa fa-check"></i><b>10.0.1</b> Popper</a></li>
<li class="chapter" data-level="10.0.2" data-path="lecture-01.html"><a href="lecture-01.html#approach"><i class="fa fa-check"></i><b>10.0.2</b> Approach</a></li>
<li class="chapter" data-level="10.1" data-path="lecture-01.html"><a href="lecture-01.html#hypotheses---process-models---statistical-models"><i class="fa fa-check"></i><b>10.1</b> Hypotheses - Process Models - Statistical Models</a></li>
<li class="chapter" data-level="10.2" data-path="lecture-01.html"><a href="lecture-01.html#small-world-large-world"><i class="fa fa-check"></i><b>10.2</b> Small world / large world</a></li>
<li class="chapter" data-level="10.3" data-path="lecture-01.html"><a href="lecture-01.html#example-four-marbles"><i class="fa fa-check"></i><b>10.3</b> Example: four marbles</a></li>
<li class="chapter" data-level="10.4" data-path="lecture-01.html"><a href="lecture-01.html#building-a-model"><i class="fa fa-check"></i><b>10.4</b> Building a model</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lecture-02.html"><a href="lecture-02.html"><i class="fa fa-check"></i><b>11</b> Lecture 02</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lecture-02.html"><a href="lecture-02.html#joint-prior-distribution"><i class="fa fa-check"></i><b>11.1</b> Joint prior distribution</a></li>
<li class="chapter" data-level="11.2" data-path="lecture-02.html"><a href="lecture-02.html#example-inflatable-world"><i class="fa fa-check"></i><b>11.2</b> Example: inflatable world</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="lecture-02.html"><a href="lecture-02.html#design-the-model"><i class="fa fa-check"></i><b>11.2.1</b> <strong>Design the model</strong></a></li>
<li class="chapter" data-level="11.2.2" data-path="lecture-02.html"><a href="lecture-02.html#condition"><i class="fa fa-check"></i><b>11.2.2</b> <strong>Condition</strong></a></li>
<li class="chapter" data-level="11.2.3" data-path="lecture-02.html"><a href="lecture-02.html#evaluate"><i class="fa fa-check"></i><b>11.2.3</b> <strong>Evaluate</strong></a></li>
<li class="chapter" data-level="11.2.4" data-path="lecture-02.html"><a href="lecture-02.html#define-parameters"><i class="fa fa-check"></i><b>11.2.4</b> Define parameters</a></li>
<li class="chapter" data-level="11.2.5" data-path="lecture-02.html"><a href="lecture-02.html#joint-model-1"><i class="fa fa-check"></i><b>11.2.5</b> Joint model</a></li>
<li class="chapter" data-level="11.2.6" data-path="lecture-02.html"><a href="lecture-02.html#posterior"><i class="fa fa-check"></i><b>11.2.6</b> Posterior</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="lecture-02.html"><a href="lecture-02.html#grid-approximation"><i class="fa fa-check"></i><b>11.3</b> Grid approximation</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="lecture-02.html"><a href="lecture-02.html#sampling-from-the-posterior"><i class="fa fa-check"></i><b>11.3.1</b> Sampling from the posterior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="lecture-03.html"><a href="lecture-03.html"><i class="fa fa-check"></i><b>12</b> Lecture 03</a>
<ul>
<li class="chapter" data-level="12.1" data-path="lecture-03.html"><a href="lecture-03.html#regressions"><i class="fa fa-check"></i><b>12.1</b> Regressions</a></li>
<li class="chapter" data-level="12.2" data-path="lecture-03.html"><a href="lecture-03.html#normal-distributions"><i class="fa fa-check"></i><b>12.2</b> Normal distributions</a></li>
<li class="chapter" data-level="12.3" data-path="lecture-03.html"><a href="lecture-03.html#prior-predictive-distributions"><i class="fa fa-check"></i><b>12.3</b> Prior predictive distributions</a></li>
<li class="chapter" data-level="12.4" data-path="lecture-03.html"><a href="lecture-03.html#quadratic-approximate"><i class="fa fa-check"></i><b>12.4</b> Quadratic approximate</a></li>
<li class="chapter" data-level="12.5" data-path="lecture-03.html"><a href="lecture-03.html#centering-variables"><i class="fa fa-check"></i><b>12.5</b> Centering variables</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="lecture-04.html"><a href="lecture-04.html"><i class="fa fa-check"></i><b>13</b> Lecture 04</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lecture-04.html"><a href="lecture-04.html#standardizing-variables"><i class="fa fa-check"></i><b>13.1</b> Standardizing variables</a></li>
<li class="chapter" data-level="13.2" data-path="lecture-04.html"><a href="lecture-04.html#plotting-uncertainty---sample-from-posterior"><i class="fa fa-check"></i><b>13.2</b> Plotting uncertainty - sample from posterior</a></li>
<li class="chapter" data-level="13.3" data-path="lecture-04.html"><a href="lecture-04.html#polynomials"><i class="fa fa-check"></i><b>13.3</b> Polynomials</a></li>
<li class="chapter" data-level="13.4" data-path="lecture-04.html"><a href="lecture-04.html#splines"><i class="fa fa-check"></i><b>13.4</b> Splines</a></li>
<li class="chapter" data-level="13.5" data-path="lecture-04.html"><a href="lecture-04.html#basis-splines"><i class="fa fa-check"></i><b>13.5</b> Basis splines</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="lecture-04.html"><a href="lecture-04.html#recipe"><i class="fa fa-check"></i><b>13.5.1</b> Recipe</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="lecture-05.html"><a href="lecture-05.html"><i class="fa fa-check"></i><b>14</b> Lecture 05</a>
<ul>
<li class="chapter" data-level="14.1" data-path="lecture-05.html"><a href="lecture-05.html#multiple-regression-models"><i class="fa fa-check"></i><b>14.1</b> Multiple regression models</a></li>
<li class="chapter" data-level="14.2" data-path="lecture-05.html"><a href="lecture-05.html#directed-acyclic-graphs-dag"><i class="fa fa-check"></i><b>14.2</b> Directed acyclic graphs (DAG)</a></li>
<li class="chapter" data-level="14.3" data-path="lecture-05.html"><a href="lecture-05.html#example-age-marriage-divorce"><i class="fa fa-check"></i><b>14.3</b> Example: Age, marriage, divorce</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="lecture-05.html"><a href="lecture-05.html#priors-2"><i class="fa fa-check"></i><b>14.3.1</b> Priors</a></li>
<li class="chapter" data-level="14.3.2" data-path="lecture-05.html"><a href="lecture-05.html#prior-predictive-simulation-2"><i class="fa fa-check"></i><b>14.3.2</b> Prior predictive simulation</a></li>
<li class="chapter" data-level="14.3.3" data-path="lecture-05.html"><a href="lecture-05.html#interpretation-5"><i class="fa fa-check"></i><b>14.3.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="lecture-05.html"><a href="lecture-05.html#plotting-multivariate-posteriors"><i class="fa fa-check"></i><b>14.4</b> Plotting multivariate posteriors</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="lecture-05.html"><a href="lecture-05.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>14.4.1</b> Posterior predictive checks</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="lecture-05.html"><a href="lecture-05.html#reveal-masked-associations"><i class="fa fa-check"></i><b>14.5</b> Reveal masked associations</a></li>
<li class="chapter" data-level="14.6" data-path="lecture-05.html"><a href="lecture-05.html#categorical-variables"><i class="fa fa-check"></i><b>14.6</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="lecture-05.html"><a href="lecture-05.html#dummy-variable"><i class="fa fa-check"></i><b>14.6.1</b> Dummy variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="lecture-06.html"><a href="lecture-06.html"><i class="fa fa-check"></i><b>15</b> Lecture 06</a>
<ul>
<li class="chapter" data-level="15.1" data-path="lecture-06.html"><a href="lecture-06.html#index-variable"><i class="fa fa-check"></i><b>15.1</b> Index variable</a></li>
<li class="chapter" data-level="15.2" data-path="lecture-06.html"><a href="lecture-06.html#four-elemental-confounds"><i class="fa fa-check"></i><b>15.2</b> Four elemental confounds</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="lecture-06.html"><a href="lecture-06.html#notes"><i class="fa fa-check"></i><b>15.2.1</b> Notes</a></li>
<li class="chapter" data-level="15.2.2" data-path="lecture-06.html"><a href="lecture-06.html#the-fork"><i class="fa fa-check"></i><b>15.2.2</b> The fork</a></li>
<li class="chapter" data-level="15.2.3" data-path="lecture-06.html"><a href="lecture-06.html#the-path"><i class="fa fa-check"></i><b>15.2.3</b> The path</a></li>
<li class="chapter" data-level="15.2.4" data-path="lecture-06.html"><a href="lecture-06.html#the-collider"><i class="fa fa-check"></i><b>15.2.4</b> The collider</a></li>
<li class="chapter" data-level="15.2.5" data-path="lecture-06.html"><a href="lecture-06.html#steps"><i class="fa fa-check"></i><b>15.2.5</b> Steps</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="lecture-07.html"><a href="lecture-07.html"><i class="fa fa-check"></i><b>16</b> Lecture 07</a>
<ul>
<li class="chapter" data-level="16.1" data-path="lecture-07.html"><a href="lecture-07.html#four-elemental-confounds-continued"><i class="fa fa-check"></i><b>16.1</b> Four elemental confounds (continued)</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="lecture-07.html"><a href="lecture-07.html#unobserved-variables"><i class="fa fa-check"></i><b>16.1.1</b> Unobserved variables</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="lecture-07.html"><a href="lecture-07.html#over-fitting"><i class="fa fa-check"></i><b>16.2</b> Over fitting</a></li>
<li class="chapter" data-level="16.3" data-path="lecture-07.html"><a href="lecture-07.html#measuring-model-fit"><i class="fa fa-check"></i><b>16.3</b> Measuring model fit</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="lecture-07.html"><a href="lecture-07.html#r-squared"><i class="fa fa-check"></i><b>16.3.1</b> R squared</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="lecture-07.html"><a href="lecture-07.html#obtaining-the-regular-features"><i class="fa fa-check"></i><b>16.4</b> Obtaining the regular features</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="lecture-08.html"><a href="lecture-08.html"><i class="fa fa-check"></i><b>17</b> Lecture 08</a>
<ul>
<li class="chapter" data-level="17.1" data-path="lecture-08.html"><a href="lecture-08.html#information-theory"><i class="fa fa-check"></i><b>17.1</b> Information theory</a></li>
<li class="chapter" data-level="17.2" data-path="lecture-08.html"><a href="lecture-08.html#divergence"><i class="fa fa-check"></i><b>17.2</b> Divergence</a></li>
<li class="chapter" data-level="17.3" data-path="lecture-08.html"><a href="lecture-08.html#estimating-divergence"><i class="fa fa-check"></i><b>17.3</b> Estimating divergence</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="lecture-08.html"><a href="lecture-08.html#log-pointwise-predictive-density"><i class="fa fa-check"></i><b>17.3.1</b> Log pointwise predictive density</a></li>
<li class="chapter" data-level="17.3.2" data-path="lecture-08.html"><a href="lecture-08.html#deviance"><i class="fa fa-check"></i><b>17.3.2</b> Deviance</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="lecture-08.html"><a href="lecture-08.html#regularization"><i class="fa fa-check"></i><b>17.4</b> Regularization</a></li>
<li class="chapter" data-level="17.5" data-path="lecture-08.html"><a href="lecture-08.html#cross-validation"><i class="fa fa-check"></i><b>17.5</b> Cross validation</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="lecture-08.html"><a href="lecture-08.html#loo"><i class="fa fa-check"></i><b>17.5.1</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="lecture-08.html"><a href="lecture-08.html#information-criteria"><i class="fa fa-check"></i><b>17.6</b> Information criteria</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="lecture-08.html"><a href="lecture-08.html#waic"><i class="fa fa-check"></i><b>17.6.1</b> WAIC</a></li>
<li class="chapter" data-level="17.6.2" data-path="lecture-08.html"><a href="lecture-08.html#standard-error"><i class="fa fa-check"></i><b>17.6.2</b> Standard error</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="lecture-08.html"><a href="lecture-08.html#model-selection"><i class="fa fa-check"></i><b>17.7</b> Model selection</a></li>
<li class="chapter" data-level="17.8" data-path="lecture-08.html"><a href="lecture-08.html#model-comparison"><i class="fa fa-check"></i><b>17.8</b> Model comparison</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="lecture-08.html"><a href="lecture-08.html#example-1-model-mis-selection-using-waic"><i class="fa fa-check"></i><b>17.8.1</b> Example 1: model mis-selection using WAIC</a></li>
<li class="chapter" data-level="17.8.2" data-path="lecture-08.html"><a href="lecture-08.html#example-2-primate-lifetime"><i class="fa fa-check"></i><b>17.8.2</b> Example 2: primate lifetime</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="lecture-09.html"><a href="lecture-09.html"><i class="fa fa-check"></i><b>18</b> Lecture 09</a>
<ul>
<li class="chapter" data-level="18.1" data-path="lecture-09.html"><a href="lecture-09.html#conditioning"><i class="fa fa-check"></i><b>18.1</b> Conditioning</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="lecture-09.html"><a href="lecture-09.html#example-ruggedness"><i class="fa fa-check"></i><b>18.1.1</b> Example: ruggedness</a></li>
<li class="chapter" data-level="18.1.2" data-path="lecture-09.html"><a href="lecture-09.html#example-tulips"><i class="fa fa-check"></i><b>18.1.2</b> Example: tulips</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="lecture-09.html"><a href="lecture-09.html#interpreting-interactions"><i class="fa fa-check"></i><b>18.2</b> Interpreting interactions</a></li>
<li class="chapter" data-level="18.3" data-path="lecture-09.html"><a href="lecture-09.html#plotting-interactions"><i class="fa fa-check"></i><b>18.3</b> Plotting interactions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="lecture-09.html"><a href="lecture-09.html#higher-order-interactions"><i class="fa fa-check"></i><b>18.3.1</b> Higher order interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="lecture-10.html"><a href="lecture-10.html"><i class="fa fa-check"></i><b>19</b> Lecture 10</a>
<ul>
<li class="chapter" data-level="19.1" data-path="lecture-10.html"><a href="lecture-10.html#markov-chain-monte-carlo"><i class="fa fa-check"></i><b>19.1</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="lecture-10.html"><a href="lecture-10.html#metropolis-algorithm"><i class="fa fa-check"></i><b>19.1.1</b> Metropolis algorithm</a></li>
<li class="chapter" data-level="19.1.2" data-path="lecture-10.html"><a href="lecture-10.html#metropolis-hastings"><i class="fa fa-check"></i><b>19.1.2</b> Metropolis Hastings</a></li>
<li class="chapter" data-level="19.1.3" data-path="lecture-10.html"><a href="lecture-10.html#gibbs-sampling"><i class="fa fa-check"></i><b>19.1.3</b> Gibbs sampling</a></li>
<li class="chapter" data-level="19.1.4" data-path="lecture-10.html"><a href="lecture-10.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>19.1.4</b> Hamiltonian Monte Carlo</a></li>
<li class="chapter" data-level="19.1.5" data-path="lecture-10.html"><a href="lecture-10.html#tuning-mcmc"><i class="fa fa-check"></i><b>19.1.5</b> Tuning MCMC</a></li>
<li class="chapter" data-level="19.1.6" data-path="lecture-10.html"><a href="lecture-10.html#stan"><i class="fa fa-check"></i><b>19.1.6</b> Stan</a></li>
<li class="chapter" data-level="19.1.7" data-path="lecture-10.html"><a href="lecture-10.html#ulam"><i class="fa fa-check"></i><b>19.1.7</b> ulam</a></li>
<li class="chapter" data-level="19.1.8" data-path="lecture-10.html"><a href="lecture-10.html#diagnosis"><i class="fa fa-check"></i><b>19.1.8</b> Diagnosis</a></li>
<li class="chapter" data-level="19.1.9" data-path="lecture-10.html"><a href="lecture-10.html#checking-the-chain"><i class="fa fa-check"></i><b>19.1.9</b> Checking the chain</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="lecture-11.html"><a href="lecture-11.html"><i class="fa fa-check"></i><b>20</b> Lecture 11</a>
<ul>
<li class="chapter" data-level="20.1" data-path="lecture-11.html"><a href="lecture-11.html#maximum-entropy"><i class="fa fa-check"></i><b>20.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="lecture-11.html"><a href="lecture-11.html#distributions"><i class="fa fa-check"></i><b>20.1.1</b> Distributions</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="lecture-11.html"><a href="lecture-11.html#generalized-linear-model"><i class="fa fa-check"></i><b>20.2</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="lecture-11.html"><a href="lecture-11.html#picking-a-distribution"><i class="fa fa-check"></i><b>20.2.1</b> Picking a distribution</a></li>
<li class="chapter" data-level="20.2.2" data-path="lecture-11.html"><a href="lecture-11.html#types-of-outcomes"><i class="fa fa-check"></i><b>20.2.2</b> Types of outcomes</a></li>
<li class="chapter" data-level="20.2.3" data-path="lecture-11.html"><a href="lecture-11.html#model-parameters-with-a-link-function"><i class="fa fa-check"></i><b>20.2.3</b> Model parameters with a link function</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="lecture-11.html"><a href="lecture-11.html#binomial-distribution"><i class="fa fa-check"></i><b>20.3</b> Binomial distribution</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="lecture-11.html"><a href="lecture-11.html#link"><i class="fa fa-check"></i><b>20.3.1</b> Link</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="lecture-12.html"><a href="lecture-12.html"><i class="fa fa-check"></i><b>21</b> Lecture 12</a>
<ul>
<li class="chapter" data-level="21.1" data-path="lecture-12.html"><a href="lecture-12.html#relative-and-absolute-effects"><i class="fa fa-check"></i><b>21.1</b> Relative and absolute effects</a></li>
<li class="chapter" data-level="21.2" data-path="lecture-12.html"><a href="lecture-12.html#logistic-regression"><i class="fa fa-check"></i><b>21.2</b> Logistic regression</a></li>
<li class="chapter" data-level="21.3" data-path="lecture-12.html"><a href="lecture-12.html#simpsons-paradox"><i class="fa fa-check"></i><b>21.3</b> Simpsons paradox</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="lecture-13.html"><a href="lecture-13.html"><i class="fa fa-check"></i><b>22</b> Lecture 13</a>
<ul>
<li class="chapter" data-level="22.1" data-path="lecture-13.html"><a href="lecture-13.html#binomial"><i class="fa fa-check"></i><b>22.1</b> Binomial</a></li>
<li class="chapter" data-level="22.2" data-path="lecture-13.html"><a href="lecture-13.html#poisson"><i class="fa fa-check"></i><b>22.2</b> Poisson</a></li>
<li class="chapter" data-level="22.3" data-path="lecture-13.html"><a href="lecture-13.html#generalized-linear-madness"><i class="fa fa-check"></i><b>22.3</b> Generalized linear madness</a></li>
<li class="chapter" data-level="22.4" data-path="lecture-13.html"><a href="lecture-13.html#scientific-model"><i class="fa fa-check"></i><b>22.4</b> Scientific model</a></li>
<li class="chapter" data-level="22.5" data-path="lecture-13.html"><a href="lecture-13.html#survival-analysis"><i class="fa fa-check"></i><b>22.5</b> Survival analysis</a></li>
<li class="chapter" data-level="22.6" data-path="lecture-13.html"><a href="lecture-13.html#monsters"><i class="fa fa-check"></i><b>22.6</b> Monsters</a></li>
<li class="chapter" data-level="22.7" data-path="lecture-13.html"><a href="lecture-13.html#mixtures"><i class="fa fa-check"></i><b>22.7</b> Mixtures</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="lecture-14.html"><a href="lecture-14.html"><i class="fa fa-check"></i><b>23</b> Lecture 14</a>
<ul>
<li class="chapter" data-level="23.1" data-path="lecture-14.html"><a href="lecture-14.html#ordered-categories"><i class="fa fa-check"></i><b>23.1</b> Ordered categories</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="lecture-15.html"><a href="lecture-15.html"><i class="fa fa-check"></i><b>24</b> Lecture 15</a>
<ul>
<li class="chapter" data-level="24.1" data-path="lecture-15.html"><a href="lecture-15.html#multilevel-models"><i class="fa fa-check"></i><b>24.1</b> Multilevel models</a></li>
<li class="chapter" data-level="24.2" data-path="lecture-15.html"><a href="lecture-15.html#varying-intercepts"><i class="fa fa-check"></i><b>24.2</b> Varying intercepts</a></li>
<li class="chapter" data-level="24.3" data-path="lecture-15.html"><a href="lecture-15.html#shrinkage"><i class="fa fa-check"></i><b>24.3</b> Shrinkage</a></li>
<li class="chapter" data-level="24.4" data-path="lecture-15.html"><a href="lecture-15.html#pooling"><i class="fa fa-check"></i><b>24.4</b> Pooling</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Learning bayesian data analysis with Statistical Rethinking</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="homework-week-4" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Homework: Week 4</h1>
<p>2021-08-30 [updated: 2021-09-08]</p>
<div id="setup-1" class="section level3" number="5.0.1">
<h3><span class="header-section-number">5.0.1</span> Setup</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="homework-week-4.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb48-2"><a href="homework-week-4.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb48-3"><a href="homework-week-4.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb48-4"><a href="homework-week-4.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb48-5"><a href="homework-week-4.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-6"><a href="homework-week-4.html#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb48-7"><a href="homework-week-4.html#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="homework-week-4.html#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions</span></span>
<span id="cb48-9"><a href="homework-week-4.html#cb48-9" aria-hidden="true" tabindex="-1"></a>dag_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(dag) {</span>
<span id="cb48-10"><a href="homework-week-4.html#cb48-10" aria-hidden="true" tabindex="-1"></a>    stat <span class="ot">&lt;-</span> <span class="fu">node_status</span>(dag, <span class="cn">FALSE</span>)</span>
<span id="cb48-11"><a href="homework-week-4.html#cb48-11" aria-hidden="true" tabindex="-1"></a>    stat<span class="sc">$</span>data<span class="sc">$</span>status[<span class="fu">is.na</span>(stat<span class="sc">$</span>data<span class="sc">$</span>status)] <span class="ot">&lt;-</span> <span class="st">&#39;intermediate&#39;</span></span>
<span id="cb48-12"><a href="homework-week-4.html#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(stat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb48-13"><a href="homework-week-4.html#cb48-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> status), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a href="homework-week-4.html#cb48-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb48-15"><a href="homework-week-4.html#cb48-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&#39;&#39;</span>) <span class="sc">+</span> </span>
<span id="cb48-16"><a href="homework-week-4.html#cb48-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_dag_text</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb48-17"><a href="homework-week-4.html#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">list</span>(<span class="st">&#39;exposure&#39;</span> <span class="ot">=</span> <span class="st">&#39;#35608DFF&#39;</span>,</span>
<span id="cb48-18"><a href="homework-week-4.html#cb48-18" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="st">&#39;outcome&#39;</span> <span class="ot">=</span> <span class="st">&#39;#22A884FF&#39;</span>,</span>
<span id="cb48-19"><a href="homework-week-4.html#cb48-19" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="st">&#39;intermediate&#39;</span> <span class="ot">=</span> <span class="st">&#39;grey50&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb48-20"><a href="homework-week-4.html#cb48-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_void</span>()</span>
<span id="cb48-21"><a href="homework-week-4.html#cb48-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="question-1-3" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Question 1</h2>
<blockquote>
<p>Consider three fictional Polynesian islands. On each there is a Royal
Ornithologist charged by the king with surveying the birb population. They have
each found the following proportions of 5 important birb species:</p>
</blockquote>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="homework-week-4.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb49-2"><a href="homework-week-4.html#cb49-2" aria-hidden="true" tabindex="-1"></a>birds <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb49-3"><a href="homework-week-4.html#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>,</span>
<span id="cb49-4"><a href="homework-week-4.html#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>, <span class="fl">0.025</span>, <span class="fl">0.025</span>,</span>
<span id="cb49-5"><a href="homework-week-4.html#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.7</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>),</span>
<span id="cb49-6"><a href="homework-week-4.html#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb49-7"><a href="homework-week-4.html#cb49-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-8"><a href="homework-week-4.html#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(birds) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb49-9"><a href="homework-week-4.html#cb49-9" aria-hidden="true" tabindex="-1"></a>birds</span></code></pre></div>
<pre><code>##      A    B    C     D     E
## 1 0.20 0.20 0.20 0.200 0.200
## 2 0.80 0.10 0.05 0.025 0.025
## 3 0.05 0.15 0.70 0.050 0.050</code></pre>
<blockquote>
<p>First, compute the entropy of each island’s birb distribution. Interpret these
entropy values</p>
</blockquote>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="homework-week-4.html#cb51-1" aria-hidden="true" tabindex="-1"></a>DT <span class="ot">&lt;-</span> <span class="fu">melt</span>(<span class="fu">data.table</span>(birds, <span class="at">keep.rownames =</span> <span class="st">&#39;island&#39;</span>), <span class="at">id.vars =</span> <span class="st">&#39;island&#39;</span>,</span>
<span id="cb51-2"><a href="homework-week-4.html#cb51-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variable.name =</span> <span class="st">&#39;id&#39;</span>, <span class="at">value.name =</span> <span class="st">&#39;proportion&#39;</span>)</span>
<span id="cb51-3"><a href="homework-week-4.html#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="homework-week-4.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Entropy</span></span>
<span id="cb51-5"><a href="homework-week-4.html#cb51-5" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(p) <span class="sc">-</span><span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p))</span>
<span id="cb51-6"><a href="homework-week-4.html#cb51-6" aria-hidden="true" tabindex="-1"></a>DT[, .(<span class="at">entropy =</span> <span class="fu">entropy</span>(proportion)), by <span class="ot">=</span> island]</span></code></pre></div>
<pre><code>##    island entropy
##    &lt;char&gt;   &lt;num&gt;
## 1:      1    1.61
## 2:      2    0.74
## 3:      3    0.98</code></pre>
<p>The information entropy describes the uncertainty in a distribution of
probabilities given the average log-probability of an event (from Statistical
Rethinking 7.2). Island 1 has the highest entropy, with the flat probability of 0.2 across 5 bird species. Island 2 has the lowest entropy, including species A with the highest overall proportion 0.8.</p>
<blockquote>
<p>Second, use each island’s birb distribution to predict the other two. This
means to compute the K-L Divergence of each island from the others, treating
each island as if it were a statistical model of the other islands. You should
end up with 6 different K-L Divergence values. Which island predicts the others
best? Why?</p>
</blockquote>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="homework-week-4.html#cb53-1" aria-hidden="true" tabindex="-1"></a>divergence <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q) <span class="fu">sum</span>(p <span class="sc">*</span> (<span class="fu">log</span>(p) <span class="sc">-</span> <span class="fu">log</span>(q)))</span>
<span id="cb53-2"><a href="homework-week-4.html#cb53-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">CJ</span>(<span class="at">p =</span> DT<span class="sc">$</span>island, <span class="at">q =</span> DT<span class="sc">$</span>island, <span class="at">unique =</span> <span class="cn">TRUE</span>)[, row_id <span class="sc">:</span><span class="er">=</span> .I]</span>
<span id="cb53-3"><a href="homework-week-4.html#cb53-3" aria-hidden="true" tabindex="-1"></a>z[, div <span class="sc">:</span><span class="er">=</span> <span class="fu">divergence</span>(DT[island <span class="sc">==</span> p, proportion], </span>
<span id="cb53-4"><a href="homework-week-4.html#cb53-4" aria-hidden="true" tabindex="-1"></a>                                            DT[island <span class="sc">==</span> q, proportion]),</span>
<span id="cb53-5"><a href="homework-week-4.html#cb53-5" aria-hidden="true" tabindex="-1"></a>    by <span class="ot">=</span> row_id]</span>
<span id="cb53-6"><a href="homework-week-4.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="homework-week-4.html#cb53-7" aria-hidden="true" tabindex="-1"></a>z[p <span class="sc">!=</span> q]</span></code></pre></div>
<pre><code>##         p      q row_id   div
##    &lt;char&gt; &lt;char&gt;  &lt;int&gt; &lt;num&gt;
## 1:      1      2      2  0.97
## 2:      1      3      3  0.64
## 3:      2      1      4  0.87
## 4:      2      3      6  2.01
## 5:      3      1      7  0.63
## 6:      3      2      8  1.84</code></pre>
<p><code>divergence(p, q)</code> = “Average difference in log probability between the target (p) and the model (q)”.</p>
<p>Model 1 predicts target 3 best (lowest divergence at 0.63) and target 2 best (lowest divergence at 0.87) because it has the highest entropy. Model 3 predicts target 1 best (lowest divergence at 0.64) because it has higher entropy than model 2.</p>
</div>
<div id="question-2-3" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Question 2</h2>
<blockquote>
<p>Recall the marriage, age, and happiness collider bias example from Chapter
6. Run models m6.9 and m6.10 again.</p>
</blockquote>
<div id="dag" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> DAG</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="homework-week-4.html#cb55-1" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb55-2"><a href="homework-week-4.html#cb55-2" aria-hidden="true" tabindex="-1"></a>    marriage <span class="sc">~</span> happiness,</span>
<span id="cb55-3"><a href="homework-week-4.html#cb55-3" aria-hidden="true" tabindex="-1"></a>    marriage <span class="sc">~</span> age,</span>
<span id="cb55-4"><a href="homework-week-4.html#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure =</span> <span class="st">&#39;age&#39;</span>,</span>
<span id="cb55-5"><a href="homework-week-4.html#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&#39;happiness&#39;</span></span>
<span id="cb55-6"><a href="homework-week-4.html#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-7"><a href="homework-week-4.html#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="homework-week-4.html#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dag_plot</span>(dag)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="data" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Data</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="homework-week-4.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb56-2"><a href="homework-week-4.html#cb56-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sim_happiness</span>(<span class="at">seed =</span> <span class="dv">1977</span>, <span class="at">N_years =</span> <span class="fl">1e3</span>)</span>
<span id="cb56-3"><a href="homework-week-4.html#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="homework-week-4.html#cb56-4" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> d[d<span class="sc">$</span>age <span class="sc">&gt;</span> <span class="dv">17</span>,]</span>
<span id="cb56-5"><a href="homework-week-4.html#cb56-5" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>A <span class="ot">&lt;-</span> (d2<span class="sc">$</span>age <span class="sc">-</span> <span class="dv">18</span>) <span class="sc">/</span> (<span class="dv">65</span> <span class="sc">-</span> <span class="dv">18</span>)</span>
<span id="cb56-6"><a href="homework-week-4.html#cb56-6" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>mid <span class="ot">&lt;-</span> d2<span class="sc">$</span>married <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb56-7"><a href="homework-week-4.html#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="homework-week-4.html#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(d2)</span></code></pre></div>
<pre><code>##                          mean    sd   5.5% 94.5%  histogram
## age       41.5000000000000000 13.86 20.000 63.00 ▃▇▇▇▇▇▇▇▇▇
## married    0.4072916666666667  0.49  0.000  1.00 ▇▁▁▁▁▁▁▁▁▅
## happiness -0.0000000000000001  1.21 -1.789  1.79   ▇▅▇▅▅▇▅▇
## A          0.5000000000000000  0.29  0.043  0.96 ▇▇▇▅▇▇▅▇▇▇
## mid        1.4072916666666666  0.49  1.000  2.00 ▇▁▁▁▁▁▁▁▁▅</code></pre>
</div>
<div id="models" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Models</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="homework-week-4.html#cb58-1" aria-hidden="true" tabindex="-1"></a>m6<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb58-2"><a href="homework-week-4.html#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb58-3"><a href="homework-week-4.html#cb58-3" aria-hidden="true" tabindex="-1"></a>        happiness <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb58-4"><a href="homework-week-4.html#cb58-4" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a[mid] <span class="sc">+</span> bA <span class="sc">*</span> A,</span>
<span id="cb58-5"><a href="homework-week-4.html#cb58-5" aria-hidden="true" tabindex="-1"></a>        a[mid] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb58-6"><a href="homework-week-4.html#cb58-6" aria-hidden="true" tabindex="-1"></a>        bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb58-7"><a href="homework-week-4.html#cb58-7" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb58-8"><a href="homework-week-4.html#cb58-8" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">data =</span> d2</span>
<span id="cb58-9"><a href="homework-week-4.html#cb58-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-10"><a href="homework-week-4.html#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="homework-week-4.html#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m6<span class="fl">.9</span>, <span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##        mean    sd  5.5% 94.5%
## a[1]  -0.24 0.063 -0.34 -0.13
## a[2]   1.26 0.085  1.12  1.39
## bA    -0.75 0.113 -0.93 -0.57
## sigma  0.99 0.023  0.95  1.03</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="homework-week-4.html#cb60-1" aria-hidden="true" tabindex="-1"></a>m6<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb60-2"><a href="homework-week-4.html#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb60-3"><a href="homework-week-4.html#cb60-3" aria-hidden="true" tabindex="-1"></a>        happiness <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb60-4"><a href="homework-week-4.html#cb60-4" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bA <span class="sc">*</span> A,</span>
<span id="cb60-5"><a href="homework-week-4.html#cb60-5" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb60-6"><a href="homework-week-4.html#cb60-6" aria-hidden="true" tabindex="-1"></a>        bA <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb60-7"><a href="homework-week-4.html#cb60-7" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dexp</span>(<span class="dv">1</span>)</span>
<span id="cb60-8"><a href="homework-week-4.html#cb60-8" aria-hidden="true" tabindex="-1"></a>    ), <span class="at">data =</span> d2</span>
<span id="cb60-9"><a href="homework-week-4.html#cb60-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-10"><a href="homework-week-4.html#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="homework-week-4.html#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">precis</span>(m6<span class="fl">.10</span>, <span class="at">depth =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##              mean    sd  5.5% 94.5%
## a      0.00000016 0.077 -0.12  0.12
## bA    -0.00000027 0.132 -0.21  0.21
## sigma  1.21318761 0.028  1.17  1.26</code></pre>
</div>
<div id="interpretation-3" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Interpretation</h3>
<blockquote>
<p>Compare these two models using WAIC (or LOO, they will produce identical
results). Which model is expected to make better predictions? Which model
provides the correct causal inference about the influence of age on happiness?
Can you explain why the answers to these two questions disagree?</p>
</blockquote>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="homework-week-4.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(m6<span class="fl">.9</span>, m6<span class="fl">.10</span>)</span></code></pre></div>
<pre><code>##       WAIC SE dWAIC dSE pWAIC weight
## m6.9  2714 38     0  NA   3.7      1
## m6.10 3102 28   388  35   2.3      0</code></pre>
<p>Model m6.9 includes marriage while m6.10 does not. The causal influence of age
on happiness is confounded by marriage because marriage is a collider between
age and happiness. Conditioning on marriage opens the path between age and
happiness, making age and happiness independent. Therefore, despite the WAIC for
m6.9 being lower, it does not tell us anything about causation between the
variables.</p>
</div>
</div>
<div id="question-3-2" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Question 3</h2>
<blockquote>
<p>Reconsider the urban fox analysis from last week’s homework. Use WAIC or LOO
based model comparison on five different models, each using weight as the
outcome, and containing these sets of predictor variables:</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>avgfood + groupsize + area</li>
<li>avgfood + groupsize</li>
<li>groupsize + area</li>
<li>avgfood</li>
<li>area</li>
</ol>
<div id="data-1" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Data</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="homework-week-4.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinking)</span>
<span id="cb64-2"><a href="homework-week-4.html#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="homework-week-4.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(foxes)</span></code></pre></div>
</div>
<div id="models-1" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Models</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="homework-week-4.html#cb65-1" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_area <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>area)</span>
<span id="cb65-2"><a href="homework-week-4.html#cb65-2" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_weight <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>weight)</span>
<span id="cb65-3"><a href="homework-week-4.html#cb65-3" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_avgfood <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>avgfood)</span>
<span id="cb65-4"><a href="homework-week-4.html#cb65-4" aria-hidden="true" tabindex="-1"></a>foxes<span class="sc">$</span>scale_groupsize <span class="ot">&lt;-</span> <span class="fu">scale</span>(foxes<span class="sc">$</span>groupsize)</span>
<span id="cb65-5"><a href="homework-week-4.html#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="homework-week-4.html#cb65-6" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb65-7"><a href="homework-week-4.html#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb65-8"><a href="homework-week-4.html#cb65-8" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb65-9"><a href="homework-week-4.html#cb65-9" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bFood <span class="sc">*</span> scale_avgfood <span class="sc">+</span> bGroup <span class="sc">*</span> scale_groupsize <span class="sc">+</span> bArea <span class="sc">*</span> scale_area,</span>
<span id="cb65-10"><a href="homework-week-4.html#cb65-10" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb65-11"><a href="homework-week-4.html#cb65-11" aria-hidden="true" tabindex="-1"></a>        bFood <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-12"><a href="homework-week-4.html#cb65-12" aria-hidden="true" tabindex="-1"></a>        bGroup <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-13"><a href="homework-week-4.html#cb65-13" aria-hidden="true" tabindex="-1"></a>        bArea <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-14"><a href="homework-week-4.html#cb65-14" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb65-15"><a href="homework-week-4.html#cb65-15" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb65-16"><a href="homework-week-4.html#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb65-17"><a href="homework-week-4.html#cb65-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-18"><a href="homework-week-4.html#cb65-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-19"><a href="homework-week-4.html#cb65-19" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb65-20"><a href="homework-week-4.html#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb65-21"><a href="homework-week-4.html#cb65-21" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb65-22"><a href="homework-week-4.html#cb65-22" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bFood <span class="sc">*</span> scale_avgfood <span class="sc">+</span> bGroup <span class="sc">*</span> scale_groupsize,</span>
<span id="cb65-23"><a href="homework-week-4.html#cb65-23" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb65-24"><a href="homework-week-4.html#cb65-24" aria-hidden="true" tabindex="-1"></a>        bFood <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-25"><a href="homework-week-4.html#cb65-25" aria-hidden="true" tabindex="-1"></a>        bGroup <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-26"><a href="homework-week-4.html#cb65-26" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb65-27"><a href="homework-week-4.html#cb65-27" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb65-28"><a href="homework-week-4.html#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb65-29"><a href="homework-week-4.html#cb65-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-30"><a href="homework-week-4.html#cb65-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-31"><a href="homework-week-4.html#cb65-31" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb65-32"><a href="homework-week-4.html#cb65-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb65-33"><a href="homework-week-4.html#cb65-33" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb65-34"><a href="homework-week-4.html#cb65-34" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bGroup <span class="sc">*</span> scale_groupsize <span class="sc">+</span> bArea <span class="sc">*</span> scale_area,</span>
<span id="cb65-35"><a href="homework-week-4.html#cb65-35" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb65-36"><a href="homework-week-4.html#cb65-36" aria-hidden="true" tabindex="-1"></a>        bArea <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-37"><a href="homework-week-4.html#cb65-37" aria-hidden="true" tabindex="-1"></a>        bGroup <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-38"><a href="homework-week-4.html#cb65-38" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb65-39"><a href="homework-week-4.html#cb65-39" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb65-40"><a href="homework-week-4.html#cb65-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb65-41"><a href="homework-week-4.html#cb65-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-42"><a href="homework-week-4.html#cb65-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-43"><a href="homework-week-4.html#cb65-43" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb65-44"><a href="homework-week-4.html#cb65-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb65-45"><a href="homework-week-4.html#cb65-45" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb65-46"><a href="homework-week-4.html#cb65-46" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bFood <span class="sc">*</span> scale_avgfood,</span>
<span id="cb65-47"><a href="homework-week-4.html#cb65-47" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb65-48"><a href="homework-week-4.html#cb65-48" aria-hidden="true" tabindex="-1"></a>        bFood <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-49"><a href="homework-week-4.html#cb65-49" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb65-50"><a href="homework-week-4.html#cb65-50" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb65-51"><a href="homework-week-4.html#cb65-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb65-52"><a href="homework-week-4.html#cb65-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-53"><a href="homework-week-4.html#cb65-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-54"><a href="homework-week-4.html#cb65-54" aria-hidden="true" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">quap</span>(</span>
<span id="cb65-55"><a href="homework-week-4.html#cb65-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">alist</span>(</span>
<span id="cb65-56"><a href="homework-week-4.html#cb65-56" aria-hidden="true" tabindex="-1"></a>        scale_weight <span class="sc">~</span> <span class="fu">dnorm</span>(mu, sigma),</span>
<span id="cb65-57"><a href="homework-week-4.html#cb65-57" aria-hidden="true" tabindex="-1"></a>        mu <span class="ot">&lt;-</span> a <span class="sc">+</span> bArea <span class="sc">*</span> scale_area,</span>
<span id="cb65-58"><a href="homework-week-4.html#cb65-58" aria-hidden="true" tabindex="-1"></a>        a <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.2</span>),</span>
<span id="cb65-59"><a href="homework-week-4.html#cb65-59" aria-hidden="true" tabindex="-1"></a>        bArea <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb65-60"><a href="homework-week-4.html#cb65-60" aria-hidden="true" tabindex="-1"></a>        sigma <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb65-61"><a href="homework-week-4.html#cb65-61" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb65-62"><a href="homework-week-4.html#cb65-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> foxes</span>
<span id="cb65-63"><a href="homework-week-4.html#cb65-63" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="dag-1" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> DAG</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="homework-week-4.html#cb66-1" aria-hidden="true" tabindex="-1"></a>dag <span class="ot">&lt;-</span> <span class="fu">dagify</span>(</span>
<span id="cb66-2"><a href="homework-week-4.html#cb66-2" aria-hidden="true" tabindex="-1"></a>    weight <span class="sc">~</span> groupsize <span class="sc">+</span> avgfood,</span>
<span id="cb66-3"><a href="homework-week-4.html#cb66-3" aria-hidden="true" tabindex="-1"></a>    groupsize <span class="sc">~</span> avgfood,</span>
<span id="cb66-4"><a href="homework-week-4.html#cb66-4" aria-hidden="true" tabindex="-1"></a>    avgfood <span class="sc">~</span> area,</span>
<span id="cb66-5"><a href="homework-week-4.html#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">exposure =</span> <span class="st">&#39;area&#39;</span>,</span>
<span id="cb66-6"><a href="homework-week-4.html#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">outcome =</span> <span class="st">&#39;weight&#39;</span></span>
<span id="cb66-7"><a href="homework-week-4.html#cb66-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-8"><a href="homework-week-4.html#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="homework-week-4.html#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dag_plot</span>(dag)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="interpretation-4" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Interpretation</h3>
<blockquote>
<p>Can you explain the relative differences in WAIC scores, using the fox DAG
from last week’s homework? Be sure to pay attention to the standard error of the
score differences (dSE).</p>
</blockquote>
<ol style="list-style-type: decimal">
<li>weight ~ avgfood + groupsize + area</li>
<li>weight ~ avgfood + groupsize</li>
<li>weight ~ groupsize + area</li>
<li>weight ~ avgfood</li>
<li>weight ~ area</li>
</ol>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="homework-week-4.html#cb67-1" aria-hidden="true" tabindex="-1"></a>compare_models <span class="ot">&lt;-</span> <span class="fu">compare</span>(m1, m2, m3, m4, m5)</span>
<span id="cb67-2"><a href="homework-week-4.html#cb67-2" aria-hidden="true" tabindex="-1"></a>compare_models</span></code></pre></div>
<pre><code>##    WAIC SE dWAIC dSE pWAIC weight
## m1  323 16  0.00  NA   4.6 0.4568
## m2  324 16  0.97 3.6   3.7 0.2811
## m3  324 16  1.15 2.9   3.8 0.2575
## m4  333 14 10.56 7.1   2.4 0.0023
## m5  334 14 10.66 7.2   2.6 0.0022</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="homework-week-4.html#cb69-1" aria-hidden="true" tabindex="-1"></a>compare_models<span class="sc">@</span>dSE</span></code></pre></div>
<pre><code>##     m1  m2  m3   m4   m5
## m1  NA 3.6 2.9 7.13 7.19
## m2 3.6  NA 5.8 6.55 6.79
## m3 2.9 5.8  NA 6.54 6.59
## m4 7.1 6.5 6.5   NA 0.84
## m5 7.2 6.8 6.6 0.84   NA</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="homework-week-4.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filled points: in-sample deviance</span></span>
<span id="cb71-2"><a href="homework-week-4.html#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Open points: WAIC </span></span>
<span id="cb71-3"><a href="homework-week-4.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Dark lines: standard error of WAIC</span></span>
<span id="cb71-4"><a href="homework-week-4.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Light lines with triangles: standard error of difference in WAIC between each model and top model</span></span>
<span id="cb71-5"><a href="homework-week-4.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(compare_models)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="homework-week-4.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftab</span>(m1, m2, m3, m4, m5)</span></code></pre></div>
<pre><code>##        m1      m2      m3      m4      m5     
## a            0       0       0       0       0
## bFood     0.30    0.48      NA   -0.02      NA
## bGroup   -0.64   -0.57   -0.48      NA      NA
## bArea     0.28      NA    0.41      NA    0.02
## sigma     0.93    0.95    0.95    1.00    1.00
## nobs       116     116     116     116     116</code></pre>
<p>Weight is the outcome in all of the models. Looking at the DAG, we see a
potential back door into avgfood and group size, but no colliders. Avgfood is a
path between area and weight, as is groupsize between avgfood and weight. The
paths for each variable that does not have confounds shown in the DAG:</p>
<p>Model 2: Weight ~ <strong>groupsize</strong> + avgfood (to determine causal effect of groupsize on weight, including avgfood to open the collider)</p>
<p>Model 4: Weight ~ <strong>avgfood</strong> (to determine causal effect of avgfood, without groupsize confusing the relationship since it’s a pipe)</p>
<p>Model 5: Weight ~ <strong>area</strong> (with avgfood and groupsize excluded)</p>
<p>Model 1 includes the most parameters and, as expected, has the highest model
fit. The dSE column returned by the <code>compare</code> function indicates the standard
error of the difference between models, with the <code>@dSE</code> slot showing this for
all combinations of models. Models 4 and 5 barely differ, as there is likely a
strong influence of area on average food. Including both area and avgfood is
like conditioning on the intermediate treatment effect. Models 4 and 5 are most
different from models 1, 2, 3. Models 1, 2, and 3 all have groupsize and the
WAIC and coeftab, as well as the DAG, indicate the models have the same
inference.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="homework-week-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="homework-week-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
